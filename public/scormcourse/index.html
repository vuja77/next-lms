<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <httpProtocol>
      <customHeaders>
          <add name="X-Frame-Options" value="SAMEORIGIN" />
      </customHeaders>
  </httpProtocol>
  </head>

  <body>
    <iframe id="ifr" src="" frameborder="0" sandbox="allow-same-origin allow-scripts"></iframe>></iframe>
    <style>
      * {
        margin: 0px;
        padding: 0px;
      }

      body {
        overflow: hidden;
      }

      iframe {
        width: 100vw;
        height: 100vh;
      }
    </style>

    <script>
      window.addEventListener('message', function(event) {
  // Check the origin of the sender
  if (event.origin === 'http://127.0.0.1:8000') {
    // Handle the message
    console.log('Received message: ' + event.data);
  }
});

// In the other frame (http://otherdomain.com)
var targetWindow = window.frames[0];  // Replace with the reference to your frame
targetWindow.postMessage('Hello from the other side!', 'http://127.0.0.1:8000');
      /*
      'CommitData',
      'ConcedeControl', // Gives control back to the LMS
      'CreateResponseIdentifier', // Create question response
      'Finish',
      'GetDataChunk',  // Retrieve stringified object with lesson progress
      'GetStatus', // Get Current Status
      'MatchingResponse', // Interaction - Question Type
      'RecordFillInInteraction', // Interaction - Question Type
      'RecordMatchingInteraction', // Interaction - Question Type
      'RecordMultipleChoiceInteraction', // Interaction - Question Type
      'ResetStatus', // Reset the Status
      'SetBookmark',   // Set identifier for bookmark
      'SetDataChunk',  // Set a stringified object with lesson progress
      'SetFailed', // Tell LMS user Failed course
      'SetPassed', // Tell LMS user Passed the course
      'SetReachedEnd', // Tell LMS user completed course
      'SetScore', // Report Users Score to the LMS (for Pass and fail)
      'WriteToDebug',
        */
      const urlParams = new URLSearchParams(window.location.search);
      const scormFilename = urlParams.get("scorm_filename");

      let iframe = document.querySelector("iframe");

      iframe.setAttribute(
        "src",
        `http://127.0.0.1:8000/storage/courses/${scormFilename}/scormcontent/index.html`
      );

      window.set = () => {
        console.log("FUNKCIJAAAAAAAAAAA");
      };
      let setup = async () => {
        window.addEventListener(
          "message",
          function (event) {
            // Provera odakle dolazi poruka
            if (event.source !== window) {
              return;
            }

            // Provera sadrÅ¾aja poruke
            if (event.data === "SCORM.data.save failed: API connection is inactive.") {
              console.log("Funkcija n.SCORM.data.get je pozvana u iframe-u!");
              // Dodajte svoju logiku kao odgovor na poziv funkcije
            }
          },
          false
        );

        window.set = () => {
          console.log("FUNKCIJAAAAAAAAAAA");
        };
        window.SetDataChunk = (a) => {
          let b = JSON.parse(a).d;
          console.log(a)
          
        };

        window.GetDataChunk = () => {
          let result = null;

          console.log("alo")

          return result;
        };

        window.ConcedeControl = window.history.back;

      };

      setup();
    </script>
  </body>
</html>
